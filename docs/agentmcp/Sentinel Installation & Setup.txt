Project Sentinel: Installation & Environment BootstrappingVersion: 3.0.0-EnterpriseModule: 19-Setup-InstallMaps to: docs/HOW_TO_APPLY.mdScope: Binary deployment, MCP server registration, database initialization, and environment verification.1. Distribution StrategySentinel is distributed as a single, static binary. This design choice is intentional to ensure "Air-Gap" compatibility and zero-dependency runtime assurance.1.1 Pre-Compiled BinariesNaming Convention: sentinel-[os]-[arch]-[version]Example: sentinel-linux-amd64-v3.0.0Example: sentinel-darwin-arm64-v3.0.0Integrity: Every binary is signed with our PGP release key.Verification:sha256sum -c sentinel.sha256
gpg --verify sentinel.sig sentinel
1.2 Building from SourceFor security-critical environments requiring auditability:# Clone the repository
git clone [https://github.com/TheArchitectit/agent-guardrails-template.git](https://github.com/TheArchitectit/agent-guardrails-template.git)
cd agent-guardrails-template/services/sentinel

# Build (Requires Go 1.23+)
# -ldflags "-s -w" strips debug symbols for size
# CGO_ENABLED=0 ensures pure Go sqlite driver usage
CGO_ENABLED=0 go build -ldflags "-s -w" -o ../../bin/sentinel ./cmd/sentinel
2. Bootstrapping the EnvironmentSentinel cannot simply "run." It must claim sovereignty over the repository.2.1 The init CommandRun this command in the root of the project you wish to guard:./bin/sentinel init --root .
What happens internally?Structure Creation:Creates .sentinel/ (Hidden state directory).Creates .sentinel/logs/ (Audit trail).Creates .sentinel/checkpoints/ (Session saves).DB Initialization:Initializes state.db using SQLite WAL mode.Runs SQL migrations (Schema v1 -> v3.0).Git Hooks Injection:Installs .git/hooks/pre-commit to ensure Sentinel validation on manual commits.Installs .git/hooks/pre-push to enforce branch protections.Configuration Seeding:Generates a default sentinel.toml with strict security defaults.2.2 VerificationRun the health check to ensure the "Jail" is active:./bin/sentinel doctor
Expected Output:[OK] SQLite Database: Connected (RW)
[OK] VFS Jail: Rooted at /Users/dev/repo
[OK] Git Repo: Clean
[OK] Policy: Strict Mode Active
[OK] MCP Server: Ready on Stdio
3. Integrating with AgentsSentinel is an MCP Server. It must be "mounted" into your Agent's configuration.3.1 Claude Desktop IntegrationEdit your standard Claude config:MacOS: ~/Library/Application Support/Claude/claude_desktop_config.jsonWindows: %APPDATA%\Claude\claude_desktop_config.jsonConfiguration:{
  "mcpServers": {
    "sentinel": {
      "command": "/absolute/path/to/repo/bin/sentinel",
      "args": [
        "run",
        "--root", "/absolute/path/to/repo",
        "--profile", "default"
      ],
      "env": {
        "SENTINEL_LOG_LEVEL": "info"
      }
    }
  }
}
3.2 OpenCode / CLI IntegrationFor terminal-based agents, you can pipe Sentinel directly or configure it in the opencode.toml:[agent.mcp]
  [agent.mcp.servers.sentinel]
  command = "./bin/sentinel"
  args = ["run", "--stdio"]
4. Operational Modes4.1 Headless Mode (CI/CD)Sentinel can run in CI pipelines to enforce audit logs on PRs.Command: sentinel audit --pr 123Function: Checks the SQLite DB to ensure PR 123 was generated by a valid session and that all tests passed inside the Sentinel context.4.2 Recovery ModeIf the .sentinel/state.db becomes corrupted:./bin/sentinel recover --force
This scans the filesystem (Markdown files, Git history) and reconstructs the database tables. It is a "Lossy" recovery (Context history is lost, but Task/Sprint status is restored).5. Security Hardening5.1 File PermissionsThe .sentinel directory should be chmod 700 (User R/W only).The sentinel binary should be owned by root if possible, to prevent the Agent from modifying the binary itself.5.2 GitIgnore StrategyEnsure your .gitignore includes:# Sentinel State
.sentinel/
!.sentinel/config.toml  <-- We WANT to commit the policy
sentinel.log
Note: We commit the config, but NOT the database.6. Troubleshooting Startup6.1 Common Errors"Database Locked": Another Sentinel instance (or a zombie process) holds the lock. Run pkill sentinel."Path Traversal Detected": You are running Sentinel from a subdirectory. Always run from Root."MCP Handshake Failed": Check if stderr logs are polluting the stdout JSON stream. Sentinel automatically redirects logs to stderr, but external libraries might interfere.