Project Sentinel: Swift Language ProfileVersion: 3.0.0-EnterpriseModule: 34-Lang-SwiftMaps to: examples/swift/Scope: Active enforcement of Swift Package Manager security, memory management (ARC) hygiene, UI testing standards, and Entitlements governance.1. The Swift Toolchain Adapter (SPM)Sentinel detects a Swift project via Package.swift or .xcodeproj. It enforces the use of Swift Package Manager (SPM) over legacy dependency managers (CocoaPods/Carthage) where possible to ensure build reproducibility.1.1 The Package Resolution GuardRule: Dependency Versions must be pinned or narrowly ranged.Enforcement:Sentinel intercepts swift package resolve.It parses Package.swift.Check: usage of .branch("main") or .revision(...).Action: Sentinel requires semantic versioning rules (.upToNextMajor). It blocks unstable branch dependencies in production releases.Message: "Dependency Violation: Unstable branch dependency detected. Use a tagged version for reproducibility."1.2 Binary Target ScanningThreat: Supply chain attacks via closed-source XCFrameworks.Enforcement:Sentinel monitors .binaryTarget declarations.If an Agent adds a new binary target, Sentinel calculates the checksum of the artifact.Verify: Checks against a known-good checksum database (if configured) or prompts the user for manual verification.Alert: "Binary Blob Added. Checksum verification required before commit."2. Memory Safety (ARC & Cycles)Swift uses Automatic Reference Counting (ARC), but Retain Cycles are a common source of leaks for AI Agents.2.1 The "Weak Self" EnforcerRule: Closures capturing self in asynchronous contexts (e.g., networking) must use [weak self].Enforcement:Sentinel scans closure blocks passed to DispatchQueue, Task, or Combine publishers.Pattern: somePublisher.sink { self.doSomething() }.Action: BLOCKED.Message: "Memory Leak Risk: Strong reference to self in closure. Use [weak self] or [unowned self]."2.2 Delegate HygieneRule: Delegate properties must be weak.Enforcement:Sentinel parses protocol usage.If a property conforms to a Delegate naming convention:Check: var delegate: SomeDelegate? (Strong).Action: Rejects code.Fix: weak var delegate: SomeDelegate?.3. Static Analysis (SwiftLint)Sentinel enforces the "Ray Wenderlich" or Apple style guides strictly via SwiftLint.3.1 Force Unwrapping BanRule: No ! (force unwrap) or try!.Enforcement:Sentinel runs swiftlint lint --strict.Rule: force_cast, force_try, force_unwrapping.Action: Commit blocked.Feedback: "Crash Risk: Force unwrap detected on line 42. Use if let, guard let, or ?? default value."3.2 Cyclomatic ComplexityRule: Functions should be simple.Enforcement:Sentinel enforces a strict complexity limit (e.g., 15).If an Agent writes a massive switch statement inside cellForRowAt:Warning: "Method too complex. Extract configuration logic into a separate view model or helper method."4. Security & Entitlements4.1 Entitlements LockdownThreat: Agent accidentally requesting "Camera Access" or "HealthKit" permissions.Enforcement:Sentinel monitors changes to .entitlements and Info.plist.Diff Analysis: If a new key (e.g., NSCameraUsageDescription) is added:Action: PAUSE.HitL: Request User Confirmation: "Agent is requesting Camera Access capability. Approve? (Y/N)"4.2 Network Transport Security (ATS)Rule: No arbitrary loads.Enforcement:Sentinel scans Info.plist for NSAppTransportSecurity.Check: NSAllowsArbitraryLoads = true.Action: CRITICAL BLOCK.Message: "Security Policy: Arbitrary HTTP loads are forbidden. Use HTTPS or specific exception domains."5. Testing (XCTest)5.1 UI Test StabilityRule: UI Tests must use accessibility identifiers, not string matching.Enforcement:Sentinel scans XCUITest code.Bad: app.buttons["Submit"] (Fragile - breaks on localization).Good: app.buttons["submit_btn"] (Identifier).Action: Sentinel suggests refactoring to use .accessibilityIdentifier.5.2 Snapshot TestingRule: Snapshots must be verified on the same architecture.Enforcement:If Sentinel detects assertSnapshot calls, it verifies the runtime environment (Simulator version/OS).If running on a different OS version than the recorded reference, Sentinel aborts the test run to prevent false negatives.6. Troubleshooting Swift Agents6.1 Common Failure Modes"Module not found": Agent added a file but didn't add it to the Target in .xcodeproj.Sentinel Fix: Uses xcodegen or tuist logic to regenerate the project file or explicitly adds the file reference via xcodebuild tools."Sandboxing Error": App crashes on file write.Sentinel Fix: Detects SIGABRT related to filesystem. Hints: "You are sandboxed. You can only write to FileManager.default.urls(for: .documentDirectory, ...)."