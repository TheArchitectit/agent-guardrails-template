Project Sentinel: Git Topology & Branching StrategyVersion: 3.0.0-EnterpriseModule: 11-Workflow-BranchingMaps to: docs/workflows/BRANCH_STRATEGY.mdScope: Enforcement of Git flow, branch naming conventions, and merge integrity.1. The "Task-Branch" BindingIn the Sentinel ecosystem, branches are not arbitrary. They are cryptographically bound to an Active Task in the State DB.1.1 The Binding RuleRule: An Agent cannot create a branch unless it has an active ticket.Mechanism:Agent calls: create_branch(name="fix-login").Sentinel Logic:Check tasks table for status='in_progress'.Found Task: ID: T-105, Title: Fix Login Timeout.Validation: Does "fix-login" match T-105?Auto-Correction: Sentinel rejects the name "fix-login" and forces the name feat/T-105-fix-login-timeout.Result: Traceability. We know exactly why this branch exists.1.2 Orphan PreventionRule: You cannot check out a branch that doesn't have a corresponding Task or is not a protected base branch.Enforcement: If Agent tries git checkout legacy-branch-from-2023, Sentinel blocks it unless the User explicitly overrides via override_policy("legacy_access").2. Protected NamespacesSentinel partitions the git graph into security zones.2.1 The Zone MapNamespaceAccess LevelPermissionsmain, masterROOTRead-Only. No direct commits. No direct pushes.release/*STAGINGRead-Only. Only mergeable via PR from feat/*.feat/*USERRead/Write. Owned by the Agent/User.fix/*USERRead/Write. Must link to a Bug Report ID.sentinel/*SYSTEMINVISIBLE. Used for state snapshots.2.2 Main Branch LockdownMechanism:Sentinel wraps the git binary.Command: git push origin main.Interceptor:if currentBranch == "main" {
    return Error("FATAL: Direct push to main is blocked by Sentinel Kernel.")
}
Bypass: None. Not even Admins can bypass this via the Agent. They must use a terminal outside the Agent's control.3. Merge Integrity (The Squash Protocol)Sentinel enforces a clean history. A "Feature" should be one commit on main.3.1 The "WIP" FilterAgents are notorious for making 50 commits like "fix", "typo", "try again".Rule: These "micro-commits" must never reach main.Enforcement:Squash-on-Merge: Sentinel enforces that Pull Requests are configured to "Squash and Merge".Local Squashing: Before an Agent can mark a task as Ready for Review, Sentinel checks the commit count.If commits > 5, Sentinel suggests: "You have clutter. Running git rebase -i to squash WIP commits."3.2 The Stale Branch ReaperProblem: Agents create branches and abandon them.Solution: Sentinel Garbage Collection.Logic:On Boot, Sentinel scans git branch --list.It compares branches against the tasks table.Condition: If Branch X exists but Task X is Done (and merged) OR Archived.Action: Sentinel deletes the local branch Branch X.4. Hotfix Protocol (The Emergency Lane)Sometimes we do need to bypass the standard flow.4.1 ActivationUser command: start_hotfix("Prod is down").Sentinel State: Transitions to HOTFIX mode.4.2 The Hotfix OverrideBranching: Creates hotfix/critical-[timestamp].Permissions:run_tests is still required.code_review is Optional (Risk Accepted).deploy is unlocked immediately.Audit: All actions in this mode are logged with Severity: CRITICAL. The User is pinned as the responsible party in the log.