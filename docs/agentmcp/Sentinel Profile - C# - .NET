Project Sentinel: C# / .NET Language ProfileVersion: 3.0.0-EnterpriseModule: 31-Lang-CSharpMaps to: examples/csharp/Scope: Active enforcement of NuGet security, Roslyn analyzer compliance, Entity Framework Core safety, and Async/Await best practices.1. The .NET CLI AdapterSentinel detects a .NET project via *.sln or *.csproj files. It wraps the dotnet CLI to enforce reproducible builds and secure dependency management.1.1 The Restore GuardRule: Immutable package restoration.Enforcement:Sentinel intercepts dotnet restore.It forces the --locked-mode flag.Logic: If packages.lock.json is missing or out of sync with the project file, the restore fails.Action: The Agent must explicitly run dotnet restore --force-evaluate via a specific Sentinel tool to update the lockfile, ensuring dependency changes are intentional.1.2 NuGet SecurityThreat: Vulnerable packages or typosquatting.Enforcement:Sentinel runs dotnet list package --vulnerable after every dependency addition.Block: If a package with a known High/Critical CVE is detected, the dotnet add package command is rolled back.Message: "Security Block: Newtonsoft.Json version 9.0.1 has critical vulnerabilities. Upgrade to 13.0.1+."2. Static Analysis (Roslyn)Sentinel relies heavily on the .NET Compiler Platform (Roslyn) to enforce code quality at compile time.2.1 The "TreatWarningsAsErrors" MandateRule: Zero warnings policy.Enforcement:Sentinel scans all .csproj files.Check: <TreatWarningsAsErrors>true</TreatWarningsAsErrors>.Auto-Fix: If missing, Sentinel injects this property into the PropertyGroup.Result: The Agent cannot compile code that contains unused variables, obsolete method calls, or nullable warnings.2.2 Async/Await HygieneRule: No async void.Enforcement:Sentinel uses a custom Roslyn Analyzer (or searches for CA2000 / VSTHRD100).Check: async void MyMethod().Action: BLOCKED.Message: "Async Risk: async void crashes the process on exception. Use async Task."3. Entity Framework Core GuardrailsEF Core protects against many SQL injection attacks, but Agents can still misuse it.3.1 Raw SQL SafetyThreat: FromSqlRaw with string interpolation.Enforcement:Sentinel scans for FromSqlRaw($"SELECT * FROM Users WHERE Name = {name}").Action: BLOCKED.Message: "SQL Injection Risk: Do not use interpolation with FromSqlRaw. Use FromSqlInterpolated or parameterized queries."3.2 The "N+1" DetectorThreat: Performance degradation via lazy loading in loops.Enforcement:Sentinel monitors the execution of integration tests.If the number of SQL queries generated by a single HTTP request exceeds 50, Sentinel flags the endpoint.Feedback: "Performance Alert: Possible N+1 problem detected in GetOrders. Use .Include() to eager load relations."4. Architecture & Configuration4.1 Dependency Injection (DI) ScopeRule: Do not inject Scoped services into Singleton services.Enforcement:Sentinel enables the ValidateScopes option in Program.cs for the Development environment.Result: The application will fail to start if scope validation fails, forcing the Agent to fix the lifetime mismatch immediately.4.2 Secrets Management (UserSecrets)Rule: No secrets in appsettings.json.Enforcement:Sentinel scans appsettings.json and appsettings.Development.json.Regex: (Password|Key|Token|Secret)\s*:\s*"[^"]+".Action: BLOCKED.Message: "Secret Leak: Do not store secrets in JSON. Use dotnet user-secrets for local dev or Environment Variables."5. Testing (xUnit/NUnit)5.1 Fact vs TheoryRule: Use Data-Driven Tests where possible.Enforcement:If Sentinel detects 5 tests named TestAdd1, TestAdd2, TestAdd3...Suggestion: "Refactor to a single [Theory] with [InlineData]."5.2 Mocking HygieneRule: Strict Moq/NSubstitute usage.Enforcement:Sentinel checks for It.IsAny<T>() overuse.If a test uses IsAny for all arguments, Sentinel warns: "Weak Test: You are not verifying arguments. Be specific."6. Troubleshooting .NET Agents6.1 Common Failure Modes"SDK Not Found": The Agent tries to use a .NET version not installed in the container.Sentinel Fix: Reads global.json, checks installed SDKs, and prompts the user to install the missing version or update global.json."Locked File": bin/Debug is locked by a running process.Sentinel Fix: Automatically runs dotnet build-server shutdown and kills orphan dotnet.exe processes before retrying the build.