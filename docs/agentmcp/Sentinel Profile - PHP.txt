Project Sentinel: PHP (Modern) Language ProfileVersion: 3.0.0-EnterpriseModule: 32-Lang-PHPMaps to: examples/php/Scope: Active enforcement of Modern PHP (8.2+) standards, Composer security, strict typing, and Laravel/Symfony best practices.1. The Composer AdapterSentinel enforces strict dependency management using Composer.1.1 The Platform CheckRule: Enforce PHP version consistency.Enforcement:Sentinel intercepts composer install.It enforces the --check-platform-reqs flag.If the Agent tries to run code requiring PHP 8.2 on a PHP 8.1 container, the operation fails immediately.1.2 Development Dependency SeparationRule: No testing tools in production.Enforcement:Sentinel checks composer.json changes.If phpunit, mockery, or faker are added to require (instead of require-dev), Sentinel blocks the save.Message: "Dependency Violation: Test tools must be in require-dev."2. Static Analysis (PHPStan / Psalm)Sentinel mandates strict typing, moving away from PHP's dynamic legacy.2.1 The "Level 9" GateRule: High strictness.Enforcement:Sentinel runs vendor/bin/phpstan analyse --level=max.Check: Missing return types, mixed types, or undefined properties.Action: The git_commit tool is disabled until PHPStan passes.Message: "Type Safety Violation: Method process() has no return type specified."2.2 Debugging LeftoversThreat: Committing debug code to production.Enforcement:Sentinel scans the diff for dd(), dump(), var_dump(), print_r(), or die().Action: BLOCKED.Message: "Debug Code Detected: Remove dd() before committing."3. Modern PHP Standards (PHP 8.2+)3.1 Strict Types DeclarationRule: Every file must start with declare(strict_types=1);.Enforcement:Sentinel parses the first non-comment line of every .php file.If the declaration is missing, Sentinel automatically injects it.3.2 Legacy Function BanRule: No unsafe legacy functions.Enforcement:Sentinel maintains a blacklist: eval(), exec(), shell_exec(), mysql_*, unserialize().Action: CRITICAL BLOCK.Message: "Security Risk: unserialize() is dangerous. Use json_decode()."4. Framework Guardrails (Laravel/Symfony)4.1 Laravel Mass AssignmentRule: $fillable or $guarded must be defined carefully.Enforcement:Sentinel analyzes Eloquent models.If protected $guarded = []; (Allow all) is found:Warning: "Mass Assignment Risk: You have unguarded this model. Ensure you utilize Request::validated() data only."4.2 Query NamingRule: No raw SQL in controllers.Enforcement:Sentinel checks for DB::select("...") inside app/Http/Controllers.Action: Rejects code.Suggestion: "Move query logic to a Repository, Service, or Scope."5. Testing (PEST / PHPUnit)5.1 Test CoverageRule: Critical paths must be tested.Enforcement:Sentinel runs php artisan test --coverage.If coverage drops below the threshold defined in sentinel.toml, the PR is blocked.5.2 Database RefreshRule: Tests must run in transactions.Enforcement:Sentinel checks for use RefreshDatabase; or use DatabaseTransactions; in test classes.If missing, it warns: "State Leak Risk: Test modifies DB without rollback trait."6. Troubleshooting PHP Agents6.1 Common Failure Modes"Class Not Found": Agent created a file but didn't update the autoloader.Sentinel Fix: Runs composer dump-autoload automatically."Migration Error": Agent modified a migration file that already ran.Sentinel Fix: Detects modification to existing migration. Suggests: "Do not edit run migrations. Create a new alter_table migration."