Project Sentinel: Scala Language ProfileVersion: 3.0.0-EnterpriseModule: 36-Lang-ScalaMaps to: examples/scala/Scope: Active enforcement of Functional Programming principles, SBT build hygiene, Scalafmt standards, and Akka/Pekko safety.1. The SBT Adapter (Simple Build Tool)SBT is notoriously complex for AI Agents. Sentinel simplifies the interface and enforces build integrity.1.1 The "Clean Build" MandateRule: Reproducible builds.Enforcement:Sentinel wraps sbt.Check: Usage of SNAPSHOT dependencies.Action: If build.sbt contains "com.example" %% "lib" % "0.1-SNAPSHOT", Sentinel blocks the commit to main. Snapshots are allowed only on feature branches.1.2 Plugin AuditingRule: plugins.sbt must be minimal.Enforcement:Sentinel scans project/plugins.sbt.Block: Agents attempting to add "convenience" plugins that alter the compiler phase (unless whitelisted).2. Functional Programming GuardrailsScala allows both OO and FP styles. Sentinel enforces the project's chosen paradigm (usually strict FP).2.1 Immutability EnforcementRule: Prefer val over var.Enforcement:Sentinel uses Scalafix or custom grep.Check: Count of var declarations in new code.Threshold: If > 0 vars are detected in domain logic (excluding tests), Sentinel challenges the Agent.Message: "FP Violation: Mutable state (var) detected. Can you rewrite this using a fold, recursion, or State monad?"2.2 null ProhibitionRule: Use Option instead of null.Enforcement:Sentinel enables the -Xlint:nullary-unit and WartRemover Null check.Check: Explicit usage of null keyword.Action: BLOCKED.Message: "Type Safety Violation: null is forbidden. Use Option[T]."3. Concurrency (Akka / Pekko / ZIO)3.1 Actor SafetyRule: No mutable state inside Actors without synchronization (though Actors strictly serialize, shared mutable state via closure is dangerous).Enforcement:Sentinel analyzes Actor classes.Check: Accessing a global var or object from inside a Receive block.Action: Warning. "Concurrency Risk: Closing over mutable state inside an Actor is dangerous."3.2 Effect System Purity (ZIO / Cats)Rule: No side effects outside the Effect wrapper.Enforcement:Check: println or db.save() calls inside a function returning IO[T] but outside the IO constructor.Bad:def save(u: User): IO[Unit] = {
  println("Saving...") // Side effect happens at construction time!
  IO { db.save(u) }
}
Action: Sentinel detects standard output/IO calls not wrapped in IO.delay or ZIO.attempt.Message: "purity Violation: Side effect executed during program construction. Wrap in IO."4. Code Formatting & Style (Scalafmt)Scala syntax disputes are legendary. Sentinel acts as the dictator.4.1 Automated FormattingRule: scalafmt configuration is absolute.Enforcement:Sentinel runs scalafmtCheck on every PR.Auto-Fix: On file save, Sentinel runs scalafmt. The Agent is not allowed to argue about indentation or alignment.4.2 Import ManagementRule: Organized imports.Enforcement:Sentinel uses OrganizeImports rule in Scalafix.Prevents wildcard imports import some.package._ unless the package is explicitly whitelisted (like ZIO._).5. Testing (ScalaTest / ZIO Test)5.1 Property-Based TestingRule: Critical logic requires property tests (ScalaCheck).Enforcement:If the Agent modifies a core domain algorithm (e.g., pricing logic), Sentinel checks for forAll usage.Prompt: "This logic is complex. Please add a Property-Based Test to verify invariants across generated inputs."5.2 Async Test HygieneRule: Never block in tests.Enforcement:Sentinel checks for Await.result with infinite timeouts.Action: Blocks commit.Message: "Test Hygiene: Infinite wait detected. Use PatienceConfig or specific timeouts."6. Troubleshooting Scala Agents6.1 Common Failure Modes"Implicit not found": The most common Scala error.Sentinel Fix: Sentinel parses the error message, identifies the missing type class (e.g., JsonEncoder[User]), and prompts: "You are missing an implicit value. Did you forget to import io.circe.generic.auto._ or define an encoder?""SBT Ivy Lock": Build hangs.Sentinel Fix: Detects lock file contention. Runs rm -rf ~/.ivy2/.sbt.ivy.lock (in the isolated CI environment) and retries.