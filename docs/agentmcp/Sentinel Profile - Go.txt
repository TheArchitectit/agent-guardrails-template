Project Sentinel: Go Language ProfileVersion: 3.0.0-EnterpriseModule: 25-Lang-GoMaps to: examples/go/Scope: Active enforcement of Go idioms, error handling, strict struct tagging, and dependency management.1. The Go Toolchain AdapterSentinel detects a Go project by the presence of go.mod. It automatically mounts the Go Toolchain Adapter which wraps the standard Go CLI tools with security logic.1.1 The go test WrapperIn Sentinel, run_tests maps to a sophisticated execution of go test.Command: go test -v -race -coverprofile=coverage.out ./...Sentinel Enforcement:Race Detection: The -race flag is mandatory. If the Agent attempts to run tests without it, Sentinel forces it on.Timeout: Hard limit of 30s per package. If a test hangs (deadlock), Sentinel kills the process and reports the stack trace.Coverage Gate: Sentinel parses coverage.out.Rule: If the diff coverage < 80%, the commit is blocked.Feedback: "Coverage Violation: pkg/auth/login.go has 0% coverage."1.2 The go mod GuardianAgents often mess up dependencies (e.g., adding a random GitHub repo).Tool: install_dep(package="github.com/gin-gonic/gin").Sentinel Logic:Allowlist Check: Sentinel checks the package against a corporate approved_libs.json (if configured).Indirect Check: Sentinel runs go mod graph to detect if the new dependency pulls in vulnerable indirect dependencies (CVE Check).Vendor Integrity: If the repo uses vendor/, Sentinel verifies go mod vendor is run immediately after.2. Static Analysis & AST EnforcementSentinel uses golangci-lint and custom AST (Abstract Syntax Tree) parsing to enforce "The Go Way."2.1 Error Handling (The "Checking" Rule)Passive Rule: "Always check errors."Active Enforcement:Sentinel parses the AST of modified files.Pattern: Function call returns (value, error).Check: Is the error variable _ (ignored) or not checked in the next block?Action: If yes, the write_file operation is BLOCKED.Message: "Safety Violation: Unchecked error from function call on line 45. You must handle err."2.2 Strict Struct TaggingPassive Rule: "Tags must be valid."Active Enforcement:Sentinel validates all struct tags using go vet.PII Check: If a struct field is named Password or Token, Sentinel checks for json:"-" or log:"redact".Action: If missing, Sentinel rejects the code.2.3 Context PropagationRule: All I/O functions must take context.Context as the first argument.Enforcement:Sentinel scans public function signatures in internal/.Bad: func FetchData(db *sql.DB)Good: func FetchData(ctx context.Context, db *sql.DB)Feedback: "Context Missing. Long-running operations must be cancelable."3. Architecture & Patterns3.1 Project Layout (Standard Go)Sentinel enforces the cmd/, internal/, pkg/ layout.Rule: Application code must be in internal/ to prevent external imports.Enforcement: If an Agent creates src/ (Java style) or puts logic in root, Sentinel blocks the file creation.Message: "Layout Violation: Go projects must use internal/ for private logic. Please move logic.go."3.2 Concurrency SafetyThreat: Goroutine leaks.Enforcement:Sentinel Greps for go func() calls that do not use a WaitGroup or errgroup.Warning: "Potential Goroutine Leak detected. Ensure you are tracking this goroutine's lifecycle."4. Sentinel-Go Workflows4.1 The "Mock Gen" WorkflowAgent Intent: "I need to mock the Database interface."Sentinel Tool: generate_mocks(interface="Database", path="internal/db").Action: Sentinel executes mockgen or vektra/mockery.Constraint: The Agent is Read-Only on the generated file. It cannot edit the mock manually; it must update the interface and regenerate.4.2 The "Wire" Workflow (Dependency Injection)Agent Intent: "Wire up the service."Sentinel Tool: run_wire().Action: Sentinel runs google/wire.Verification: Checks if wire_gen.go compiles.5. Troubleshooting Go Agents5.1 Common Failure Modes"Undefined: foo": Agent forgot to import a package.Sentinel Fix: Runs goimports automatically on the buffer before saving."Cycle detected": Agent created a circular dependency.Sentinel Fix: Analyzes imports and suggests: "Move User struct to a shared types package to break the cycle."