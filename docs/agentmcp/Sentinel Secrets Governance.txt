Project Sentinel: Secrets & Identity GovernanceVersion: 3.0.0-EnterpriseModule: 17-Standard-SecretsMaps to: .github/SECRETS_MANAGEMENT.mdScope: Active prevention of credential leakage, identity management, and secure environment configuration.1. The Zero-Leak PolicySentinel assumes that the LLM will eventually try to leak a secret, either through hallucination, error, or prompt injection. The system is designed to catch this exfiltration at the I/O Boundary.1.1 The Egress Firewall (Stdout/Stderr)Mechanism: Sentinel wraps the stdout and stderr pipes of the Agent process.Heuristic Analysis:Regex: Scans for known patterns (sk-[a-z0-9]+, AKIA..., -----BEGIN RSA PRIVATE KEY).Entropy: Scans for high-entropy strings (random-looking alphanumeric sequences > 20 chars).Context: Scans for keywords like "password", "token", "secret" followed by an assignment operator.Action:Redact: Replaces the detected string with [SENTINEL-REDACTED].Alert: Logs a Security/LeakAttempt event in the Audit DB.1.2 The File System FirewallMechanism: Sentinel intercepts write_file and git_commit.Scan: Before writing to disk, the content buffer is scanned.Block: If a secret is detected in a file that is not .env (e.g., hardcoded in main.go), the write is REJECTED.Error: "Security Violation: Hardcoded credential detected in source code. Use os.Getenv()."2. Identity & Access Management (IAM)Sentinel manages who the Agent is.2.1 The "Agent" User ProfileConstraint: The Agent should never run as root or the primary user.Sandbox: Ideally, Sentinel executes the Agent's shell commands within a dedicated sentinel-user context or a Docker container.Filesystem Permissions:~/.ssh/: No Access.~/.aws/: No Access.~/.config/gcloud: No Access.Access Method: The Agent uses Sentinel Tools (get_secret("aws_key")) to access credentials, rather than reading files directly. This allows Sentinel to audit every single access.2.2 Short-Lived CredentialsIntegration: If configured with Vault or AWS STS.Workflow:Agent needs to run Terraform.Agent calls request_access(scope="infra").Sentinel requests a Temporary Token (TTL 15m) from the provider.Sentinel injects this token into the environment variables of the next command only.Result: The token expires automatically; no long-term keys exist in the repo.3. The .env Governance ProtocolThe .env file is the most common leak vector. Sentinel locks it down.3.1 The Immutable TemplateRule: .env.example must exist and be up to date.Check: When write_file(".env") occurs, Sentinel verifies that every key in .env exists in .env.example (with dummy values).Enforcement: If a new key STRIPE_KEY is added to .env but missing from .example, Sentinel blocks the write: "Documentation Drift: Add STRIPE_KEY to .env.example first."3.2 GitIgnore EnforcementRule: .env must be gitignored.Check:Agent creates .env.Sentinel immediately checks .gitignore.Auto-Fix: If .env is not ignored, Sentinel automatically appends it to .gitignore before allowing the file creation.